import unittest

import numpy as np

from plant3dvision import arabidopsis

test_pts = [[394.2727091214317, 424.922744286004, -6.251509491114256], [393.6895148393338, 422.1534230710386, 16.611893994430606], [392.25291072003427, 413.5559476712703, 11.939644894519267], [395.2417608562119, 414.37218315109425, 5.382867543213782], [391.2104559004474, 414.9685241691556, 13.585513390235736], [382.33266578745804, 416.2101212605101, -7.667471015373848], [395.24349086978333, 409.0875483170868, 7.808106994942402], [384.09319090024746, 419.15675804423074, -1.957672490946505], [400.9090225645903, 419.8492363661647, 6.919271549412624], [382.42072309913584, 416.3750118395497, -7.346611046302706], [390.7818829360638, 419.0975050062172, 14.11416063996968], [386.24896322476764, 420.77010289046996, 2.11103051929987], [394.19799404155583, 422.3823151711093, -0.7122594572405261], [385.48638054658994, 429.0142156237725, -10.057039427265918], [386.2956288206775, 420.7470095946032, 24.879465669841817], [391.6766644557052, 414.4932319636005, 12.879411569309413], [392.84946166633796, 421.385325387776, 16.51412921254075], [395.78877753421267, 417.7200300681634, 5.477540707895963], [398.6163262054029, 419.64953335532414, 6.27565794203218], [386.59656490060905, 428.80792695347776, -9.862480247419343], [410.663009857605, 423.28806972854125, -6.8825821017084206], [390.74578340855135, 415.6721029110437, 14.384905197434055], [383.54386097576133, 419.1252826480377, 29.165543739247948], [378.65593136696276, 417.0451516158512, 45.387925669019374], [399.90916957188136, 429.97249953619047, 30.215960575960615], [354.1605062401045, 438.5137275148651, 97.32781712208381], [386.5370578340516, 420.2810413493864, 22.791457241716497], [391.72034625810517, 425.0472567298739, 27.08341603698461], [387.51030246134525, 421.0385097730141, 3.5799435000094686], [395.1303433242625, 412.26469478400185, 6.579777580435872], [377.7064154154818, 415.67692478443564, 23.209537568514108], [380.1239922121563, 429.68599442113174, -11.426835159795408], [396.7972630084268, 427.0501177473549, 30.230461241122075], [389.45118384442975, 421.1546351128298, 34.694433805927716], [392.9972651175244, 422.72898275060317, 33.92274716615175], [386.2965927898079, 420.4595962677253, 23.937235652272523], [388.5298259308804, 419.8931085825934, 19.213924921398366], [394.9874582365201, 410.09528971763973, 7.832397719174235], [379.1395033662238, 415.94327090362265, 43.987819161975125], [382.73854982466327, 407.7179935393262, 40.646454876188564], [380.47463980930917, 418.7209478747627, 39.031544298537824], [381.6536725816048, 418.10232702614576, 26.09838548025396], [405.6714119535553, 419.08176164166025, 8.273827841324646], [382.3300544382666, 408.38285214042907, 41.02206763755876], [379.1062600003032, 418.75420295937226, 40.55559489549441], [390.81145648306034, 419.7786206347735, 16.57038913929051], [390.5117577698957, 419.9400421116803, 11.581290446963468], [395.5724260137443, 423.84307058154076, 16.660249904224425], [385.3263521473312, 419.81679617319, 34.01996198188782], [378.22846210082395, 419.0404356175364, 41.03617907018752], [391.097208485464, 421.8383796132701, 34.401472857201284], [387.5445768645565, 400.92198348018076, 36.23419948553642], [382.5749409805754, 416.67111176543887, -6.783632071654377], [408.6514781169079, 418.20905619962474, 9.288327717109986], [377.79400663537524, 417.45184041778884, 51.81621451552583], [396.8066251573707, 432.5744896487109, -16.78519921943449], [373.46901948050703, 420.0443093213343, 61.83704777872501], [373.6821160533757, 406.90670387195104, 74.12679744776689], [384.17221997982915, 425.26966690089733, 80.43429513805708], [386.6639415717613, 426.69724923254313, 79.8580097431764], [402.0428053258256, 432.3268153352936, 30.21817132376266], [356.5791526444446, 415.34799485790825, 71.79612007140398], [374.1951625104105, 418.9042755468883, 83.58098802095512], [388.67165659358244, 399.4066863984528, 35.20198233340772], [373.8044217048404, 405.90602210971065, 73.22709600126184], [377.2546224175778, 420.1539993215382, 80.73920956774154], [400.750022057796, 430.88627118694365, 30.214481582792878], [388.0715249926259, 427.5169782344634, 79.505619986679], [359.2212746983013, 415.4432370182174, 75.18429659973663], [368.68806835428006, 416.7949903155791, 105.79387197891926], [376.48895074583584, 419.0399248496394, 91.04848256786904], [377.76151214545416, 419.41588864061174, 91.24247177102514], [375.35724847794745, 397.8729359981753, 111.49315118706363], [379.04845851127044, 392.5698945267052, 110.3176147241568], [377.65991037130107, 394.4337239182974, 110.7286663970791], [357.78376046129233, 415.35544762202875, 73.34297771455796], [380.914261502699, 390.1628942419775, 109.78829970248599], [366.8961185424971, 413.7954426044208, 124.50874038645783], [375.8977770014176, 419.6579182799706, 82.14433212577752], [362.6304410522481, 425.12808797402886, 102.98609578007581], [355.2244934828442, 436.6580208807139, 98.2767682116167], [361.160450269318, 427.1857641030346, 102.38724115710146], [371.4858819815339, 424.03149354111116, 60.294030649687826], [355.7984917754234, 435.652575338149, 98.78339211771106], [352.3513556998909, 414.71296354196784, 140.95287958197187], [365.2413820480719, 412.08817290801926, 128.893749133508], [399.7944986956476, 419.87057950584614, 6.625308314091804], [365.1324405149434, 411.6186459824844, 133.1609083794085], [364.317601041804, 411.27269019071457, 129.67648095734052], [360.3065429295519, 407.9187552407831, 127.53150166279646], [343.6931839220629, 419.84780741083114, 134.60982429864617], [351.6927873284155, 395.0634220029059, 112.85208940975815], [361.80547052089327, 410.9753375171416, 145.0427802276109], [370.51756624810963, 422.9890875363756, 119.91857776840085], [368.7511609512296, 417.218138691745, 120.803828808398], [354.2344434825224, 438.38595160951036, 97.39400105251703], [361.02243819199686, 415.62185012887153, 77.3608643634268], [395.0519286864349, 426.30171305346227, -17.249190484827288], [370.3820051660349, 409.2986900728038, 114.3079754737334], [356.7961657225793, 404.09420511635824, 123.9117613222083], [364.84502260040045, 410.81016834193434, 142.0428730318077], [369.2177680462066, 413.57820375559385, 116.07208805505104], [374.17269079189805, 399.97219633657596, 111.98823198835005], [373.37306558964195, 436.60767347463474, 118.09467730745797], [357.40491625322596, 412.4547240020309, 143.71349012445043], [372.97746297459327, 433.88287518016415, 118.48182315325853], [375.1910202917015, 415.2899198735049, 59.07518679558948], [352.6398455178158, 397.0144523398481, 115.37756492024042], [371.14302611926564, 407.0000641743921, 113.79282145527534], [368.0563974920715, 418.1017739683186, 103.90641884565028], [352.2213153591262, 396.15703315197544, 114.2718296793475], [355.0430833352997, 401.51284424258563, 120.96498794330455], [373.5927043130714, 407.8808097020865, 74.91789673178596], [365.15013190760783, 416.30814318205785, 81.64670497698822], [367.105047713758, 416.7298926801502, 83.00121818451454], [344.57136028423474, 419.28710325842604, 135.26838704515635], [372.10870862047926, 429.22713364048565, 119.16483661812396], [356.51389776363794, 434.43237422821926, 99.39036039106941], [404.87491402129893, 430.27781430775923, 16.196351232185105], [374.59147240412534, 417.75099223175, 73.56900223238901], [341.67353680822845, 421.1902071580989, 133.0874700210748], [369.0913868728231, 414.6917361387868, 111.06916260469029], [372.8884030539234, 399.6627172560109, 47.82418007322294], [383.7357362307905, 406.1796526960831, 39.73209918750992], [372.52727883129546, 397.60096300560764, 45.92544082464522], [371.1418464578193, 424.99177595467734, 59.79091714371], [393.4473455531899, 430.7999754439723, 78.02767736346136], [370.8563778806989, 426.0448791432077, 59.156621678289376], [371.18271766131164, 436.5666054001712, 50.818055394322215], [370.97620815097054, 434.5021228590555, 52.49484322258549], [370.56960920638346, 429.8036460565916, 56.35633619065685], [379.1204350081322, 416.6769908715828, 24.742931147107214], [371.22845722799855, 437.0424936819377, 50.43268728852285], [370.5553738382634, 429.241360964906, 56.80777271905075], [380.3117299319091, 390.91661441278944, 109.95399739253469], [373.46899497682875, 411.58829805677055, 77.27051943684832], [372.664995461972, 421.43953509879486, 61.41178767622488], [364.2568160914955, 409.9949098489151, 146.96490694714402], [374.5649012821703, 409.24751466122694, 56.902758476939695], [378.4444903516355, 417.15706358018974, 47.38263724803688], [371.5500479502762, 417.41848474582594, 94.87824023530756], [378.2631121861708, 393.5963371554288, 110.54456251281826], [390.836130878394, 426.3117386238541, 87.76467943398643], [394.28474577691605, 428.2721632442396, -13.768920321248258], [394.73415057003996, 427.8770215265395, -14.963767871115344], [358.0902340345341, 405.60939214364805, 125.41944482163095], [374.8246723741241, 399.4699638239288, 66.98666206362581], [381.24533264277295, 420.7027895714318, 91.09993041969578], [374.2814478641233, 418.3583910889355, 91.53625838937832], [374.71382967211997, 417.8209228781712, 72.39944316816273], [399.71558534482887, 427.50552456001566, 17.056656538441032], [395.08437833789515, 426.1125687803652, -17.500299796998686], [374.0926996549326, 442.4161183544794, 117.34752704841146], [378.28386435250763, 421.0809006072915, 81.0012411781379], [375.82802809393064, 420.6815607797984, 40.567633924355796], [365.88052757654896, 426.5220160329403, 34.873604816376215], [360.8714699651214, 428.5956612431231, 32.13156337535816], [367.3320893533662, 425.8388149192445, 35.76093353524377], [375.22044303740563, 413.6262304984719, 19.210052804831097], [374.8430436928472, 417.2937499836412, 61.536139644302104], [365.0157090283744, 426.9053137451362, 34.364773468712094], [375.58455198609937, 413.946325113071, 19.8570025187059], [360.41206446816875, 428.77898590993834, 31.90355983506272], [370.997906084228, 423.8768316273543, 38.119017620360985], [373.2623522774684, 422.4838025928513, 39.462481383434174], [387.04958020493297, 401.58626674083433, 36.68715361772882], [374.3512426907389, 407.72004840001443, 55.59230748851699], [353.10242550808374, 415.5261987905164, 67.48112758740433], [398.10616258977876, 422.4338441044812, -4.581855916634523], [407.84919753392336, 422.60007032925887, -6.464994640769748], [399.8577933258676, 421.98633518548934, -4.836785940383253], [406.142153732283, 422.2238076193954, -6.162611844985693], [411.46904969081965, 417.2313119721258, 10.368949436464437], [411.1759268982529, 417.33861912172205, 10.251282388107764], [403.90676133954923, 421.89284631325387, -5.709842347520937], [358.6975894764104, 430.8866923081755, 100.99638348940142], [368.67928982473194, 415.4550891221211, 119.55919695853731], [370.9249414696694, 434.0021260822092, 52.903988753347235], [409.5786531378025, 417.9025976897101, 9.630874682827027], [371.5092688094062, 426.6010932830011, 119.53655062176384], [374.70987318062515, 413.1215085171062, 18.12397276402175], [394.0983936130093, 421.61417543523294, 1.0039393474203504], [373.0803429429044, 420.72979133647084, 61.65300122842544], [384.544285362651, 405.0330144327855, 38.98918707035882], [383.0846014905087, 417.6289803247169, -4.954646941833951], [369.2788815614952, 424.84051508104034, 37.01938747118792], [385.2495591450179, 420.23561758198014, 0.5098607875626624], [386.73225420701954, 420.8855860362366, 2.7005746983414074], [383.4775476527405, 418.29276897010556, -3.6752624544973833], [387.1975907791627, 419.881562648574, 20.569793941411262], [404.2049068349505, 419.42706229099383, 7.8252212202703815], [382.84241352329497, 417.1776466811322, -5.816375965447482], [359.2234006051094, 430.0624756580834, 101.35225403575464], [387.8004964431083, 428.58153429948993, -9.669315790214224], [389.19776693099914, 423.33922568105277, 26.331593688990726], [394.901076982372, 423.8502068873665, 33.21080861716421], [376.8045193183126, 414.99418429552776, 21.98981919805584], [357.42371479945814, 404.88508966380516, 124.73852091656174], [402.9125075365194, 419.6578239454701, 7.462764326034947], [403.5045252304084, 429.5961362124417, 16.459087409952538], [396.4778198062145, 431.9981915229701, -16.25720180851845], [392.85285986758055, 425.67519791151994, 27.460840292404736], [398.14099883982215, 426.14931585728493, 16.93747740063742], [398.84589891081055, 426.7735169266012, 17.008611478456714], [389.07418658465156, 398.8672740110759, 34.83191338735141], [393.9124203733846, 426.28825798209397, 27.82966321425885], [388.30981929291966, 420.7514459671502, 34.80146443997544], [404.1674031500501, 429.9323387602754, 16.334738826703806], [374.2730220919191, 412.65096951720244, 17.12403206228929], [385.66937475338744, 420.4963633013916, 1.2290574895494282], [381.7637522105599, 409.3671507223494, 41.53933897533226], [372.12905891496683, 410.0183842582062, 11.790073401554954], [374.00001210926115, 412.33747103285117, 16.459144874959673], [392.17983910342053, 422.3079290149561, 34.17236797241751], [386.7029689092037, 402.04459064424475, 37.006311517216986], [388.31457897113677, 399.8884387290888, 35.53023828766867], [382.0497388416243, 408.8602800354206, 41.278062805206694], [390.39704381620777, 420.33188484506246, 10.13006955294668], [384.0048457775928, 419.48560728610676, 35.176154526140934], [395.70721634556327, 430.83575017575174, -15.108226113452329], [401.86126991247477, 419.8127739848401, 7.175690703402843], [370.69274944118695, 431.6155157367947, 54.86819923840055], [363.3829956244044, 415.9629773637219, 80.02978088405203], [377.9683431243192, 417.4149733881337, 50.693724689313015], [374.88148607102704, 417.9020908063517, 70.41643128959375], [369.90475672212784, 420.94970020212116, 120.08773721539978], [390.29101640313087, 428.8507958330079, 78.9118510853783], [369.87102018827164, 417.39756140755867, 83.88083982263748], [372.2451460983576, 422.3140111166062, 61.05319422195979], [373.7836572612494, 400.71265546120657, 112.16847696641211], [369.5407544768269, 417.12749620035106, 100.84210244226702], [393.49117567412804, 428.0662041216845, 86.77316624057279], [374.0706639650614, 421.9420692463967, 39.88648802000616], [348.8915528014484, 416.60587960171296, 138.51432770964726], [382.34984141727995, 421.22994947878357, 90.83574782599862], [380.0973607203016, 420.20229553637694, 91.33273518922982], [379.4595253477499, 419.94976457749937, 91.40873004581445], [364.90217151348725, 422.1292449857167, 103.50246795438498], [374.3967686338318, 402.19933556572306, 69.65519480041891], [355.45821379020975, 415.35559417665064, 70.3557334198899], [382.47970778083504, 424.2799258047165, 80.80546531721892], [373.4837790781661, 410.65669776696313, 76.74357903069244], [375.2096981998389, 396.66610700049546, 64.33864194632918], [374.63219119888544, 400.7013055886403, 68.18685776438181], [373.4910933489538, 412.8178258161988, 77.83865925946337], [375.0432276448994, 398.02766220957875, 65.60113502581059], [386.34863180103287, 423.48288890637, 89.47935339647965], [389.43007312925977, 428.32825643640643, 79.14795278924996], [392.8661538307908, 427.6648028087368, 87.00121793759098], [388.6151276014665, 424.8745901931876, 88.62851420435187], [369.05905711996377, 415.41966119704495, 108.9932486634178], [394.87426066355596, 428.98613523956055, 86.27290512522517], [368.8778685459979, 416.3036296426052, 106.7048433515678], [374.6502702976578, 399.0781473877669, 111.77475230294976], [374.793979563119, 417.87174415763195, 71.58796977733456], [365.4301600073791, 421.45115333726136, 103.54862341457373], [370.9367290606802, 417.2113720562682, 96.19042534452934], [364.07791689535145, 423.2017082213194, 103.35989249574456], [373.14098634641056, 434.9867270297084, 118.3207067349483], [370.6111741435308, 417.15357382725495, 97.1228138918326], [377.1662714308679, 395.1248382767998, 110.88337897334176], [372.75967682417644, 402.86726012965045, 112.72889014837135], [363.3124636466586, 424.21006616847114, 103.19061965472713], [373.5300257677027, 413.7159350178855, 78.21146993349119], [365.11181882052074, 411.7505360997192, 131.45987300787502], [376.19775779468785, 396.6090169227252, 111.21268308505913], [362.4221009457854, 409.8050413126412, 128.96842920192572], [365.20272068999856, 411.55461626355276, 134.44788912907356], [365.6612182156099, 412.50882489935776, 127.98679318296304], [372.4412442439176, 430.8530606673548, 118.92295868214549], [373.5476245187158, 408.7839596710764, 75.54920358281494], [364.44948920925265, 416.1631662958529, 81.05076673905246], [357.13431037673956, 433.39200956810237, 99.88315902548653], [358.3887471292736, 412.0622032779887, 144.17943755253913], [394.9825094824079, 426.6355199692184, -16.784710798313082], [349.4561387014191, 416.2825628840767, 138.93199780174942], [346.7003063998727, 417.9445710283254, 136.8723125353563], [355.82951896263927, 413.1132568410966, 142.9302355666419], [361.9431421536608, 409.40807229351907, 128.59373005465258], [352.93334651998225, 397.6052694161555, 116.1408217834523], [355.5274599759534, 402.3039944982682, 121.9038273078915], [371.9510018406017, 404.8179099433901, 113.25430721902823], [373.3718420014415, 402.1618825831274, 50.22058805273931], [373.6780098419013, 438.87240696698655, 117.80105147016411], [384.1344379836695, 405.61624167151547, 39.36466543225434], [355.93449876119473, 402.92202084061984, 122.61364825433307], [394.1131070874416, 431.2110735058402, 77.82954238053036], [353.3151889946862, 415.5016055595739, 67.7316407050376], [373.05703545197247, 400.54881885444183, 48.65854100973385], [373.49406526164677, 402.79997678736197, 50.849521249277515], [372.6077410086509, 398.1028945695994, 46.38134581792], [395.0668782435451, 426.2214359740724, -17.355948716415572], [394.877910851795, 427.2469516084898, -15.892554942047218], [342.9441889571888, 420.35055285384743, 134.04365217745686], [374.7789343496938, 399.80129864521336, 67.3076784443103], [374.674488587528, 421.50036378927365, 40.17116463957628], [364.1831615441082, 427.26719055549654, 33.88644171223181], [362.7688798520339, 427.8478033170608, 33.10849033805939], [368.0065196840784, 425.4982297540221, 36.19633211722437], [368.7647819850888, 425.1076418882817, 36.68843233228646], [361.41200823320213, 428.38610739816755, 32.40388146631755], [381.4033034694008, 410.07563023389645, 41.8671614912531], [375.1398725210493, 397.31496369836105, 64.93500943756509], [405.4611182165756, 422.0994609891815, -6.031728581828158], [401.5575616501697, 428.5769277460868, 16.800761142824342], [390.6696981077049, 417.0221066308501, 14.724631107570064], [371.75189374227193, 427.59593083998016, 119.40317108504598], [386.77587131268575, 420.0282785200202, 21.466029812681438], [394.95277989782653, 426.7981337651457, -16.557356784835115], [373.93612095415983, 405.1577923350596, 53.18271658449738], [384.59514234751856, 419.69104197973775, -0.8075784727698071], [405.63076128389406, 430.6183671495694, 16.05211803583702], [372.3802836491979, 410.34656904670163, 12.41356595362982], [373.28513422280815, 411.47880065512953, 14.670582316303173], [381.4018004062059, 418.8789684663864, 37.55316952419769], [406.1504335119023, 430.84497856331205, 15.951268228527285], [385.05554156063994, 404.3035527294511, 38.51936675306115], [395.95975182802874, 424.5805111308167, 32.72543966622186], [375.013055975605, 417.80107365508286, 66.16220257377226], [374.4423056423522, 417.63587497372515, 74.94320378608263], [366.0316505867428, 416.4916277088629, 82.33546665773922], [360.1234767056002, 415.50231004359705, 76.33576652840863], [394.0525420720897, 428.4462630437296, 86.5672686302144], [386.45851967497043, 402.3847767803723, 37.2299886403484], [373.8408739726371, 414.80476201156534, 78.21482850818636], [373.5106784654449, 409.70599575696104, 76.16089537453034], [380.876099025467, 423.09407070644556, 80.91309761275792], [374.9729480070676, 417.912552809159, 69.03479444198635], [361.1822008509344, 408.740039778629, 128.18670329011465], [354.82280746139696, 437.3557886101162, 97.92402816002485], [372.3426533122861, 403.8230973587948, 112.98071444467409], [351.54748520290786, 415.12667284985264, 140.42721257260882], [374.5207805557964, 401.4059881851766, 68.87882042295499], [372.63069993549317, 431.86364221944143, 118.77453845226127], [379.8321372152937, 391.53690210649563, 110.09003895257896], [354.26740537070606, 400.13953920793307, 119.30525671600873], [354.5641861315461, 437.80461185058005, 97.69323646551368], [372.8188028890003, 432.9532891768691, 118.61514193377342], [359.82035161308573, 429.1159304127025, 101.76184742738104], [347.8490558948022, 417.25031447628453, 137.7355514992216], [385.0360865884478, 422.69318442136796, 89.9750403754069], [373.55176827136626, 437.92699776179745, 117.91707945935987], [378.1897012982864, 417.3236665500297, 49.171997462823036], [341.0878787438181, 421.58272882162856, 132.64859954619453], [357.7344857689618, 432.40546497837084, 100.34792472024404], [370.77159786718465, 408.08448054922627, 114.05906562270596], [352.445412334506, 396.61558442606866, 114.86269433753888], [373.321032529228, 401.6478535804855, 112.41153461226864], [370.79556883666015, 432.7045542866211, 53.97029285672005], [372.70796365212226, 398.6652400985125, 46.89702532853674], [370.681261602798, 427.079545052251, 58.44940789001264], [370.5870944627036, 428.1002458795402, 57.69582042807717], [371.12436546527414, 435.9572162399627, 51.311877681221645], [362.1449571412728, 428.0964046134758, 32.77946245191083], [377.62145992421983, 417.47545366645534, 52.834887814100156], [374.71093861513845, 410.503091953552, 57.790516412276006], [382.98152365576345, 421.5541348730966, 90.64987132379125], [406.80526649791955, 422.36764081552235, -6.283549772549307], [387.8012386092015, 400.57309759438505, 35.99797157688285], [387.53637159489, 420.48449539393044, 34.79539725835927], [373.6633848528714, 403.6713062498801, 51.708957505727504], [375.0289363619475, 417.8603777672381, 67.77801020995312], [391.50083137794553, 426.7435093579509, 87.51613452754862], [407.2746586676385, 418.6408723192354, 8.798094390794624], [374.23927422674177, 403.16368168503334, 70.60729926918006], [353.7270671331999, 415.46515351834626, 68.22799286070233], [359.6369350298287, 407.29137927931316, 127.0105052489045], [363.30131838394794, 427.6348792833301, 33.39487660293771], [351.9588677417268, 395.61226141758, 113.56381411872022], [371.05148683629795, 435.23979865076865, 51.89483803366368], [384.816719874624, 419.9137501067162, -0.30948516410330706], [342.385453067905, 420.71763029937824, 133.62221164875288], [402.53634701297375, 421.78611190157625, -5.414202852455674], [370.1843180642856, 417.11337822569357, 98.57907948024481], [360.4422104238615, 411.36306991691123, 144.83648351295227], [353.352226231143, 414.20252332672555, 141.59624229677362], [394.5689149164046, 429.43594792430014, -13.556992397581812], [396.80326049526093, 424.95593165413817, 16.798514063313966], [384.63270898849487, 429.1555069923151, -10.22289064368066], [396.9982474444017, 425.13058985843463, 16.81919923139177], [383.8095071603332, 418.76751054975176, -2.7390926408817178], [391.468613764822, 415.7395512281134, 13.509705958007109], [385.5638584090285, 403.60491630983313, 38.052056784563455], [379.64350299018884, 416.9767599918828, 25.059727443804938], [372.91536568770425, 411.01833666339127, 13.736662426872313], [395.34552541421436, 413.4173891226301, 5.6547136194998915], [378.6340052804802, 416.35788092289187, 24.34761594524391], [400.847215713172, 428.15765037851787, 16.902016852649837], [378.7198279184003, 417.22089995207637, 43.72422850796119], [389.1103809694562, 428.29327587291556, -9.563658264082523], [378.1787804819246, 416.03469279859115, 23.848531231433032], [385.5818265714084, 426.0790945701105, 80.10992421611228], [399.0040797470041, 429.0174858510325, 30.2355776045005], [399.3447390099195, 429.36769046113056, 30.223777567689353], [395.19570494337745, 416.1404720782981, 5.356581596185522], [379.84694328739494, 413.9087099312667, 43.22759336556395], [379.8312330570828, 418.6342074771832, 39.92818837389973], [396.7914775702528, 426.16005408116484, 31.441691580851177], [390.4340152892349, 421.557112073789, 34.53385120156256], [382.9179636830974, 419.21076514483656, 36.241772937854506], [379.4578009537014, 415.04763039312445, 43.62005648254989], [378.5654199384059, 417.11662074474975, 46.17039110515076], [380.23382356781934, 412.7953969929701, 42.893558560733155], [376.8592078497558, 417.1428119968139, 55.13493717895565], [370.64380490352266, 431.02733091244875, 55.3531457232127], [402.51017403200547, 429.0816219159601, 16.635951169024757], [374.93491487600096, 412.212026804642, 58.12487473221381], [373.97730300157724, 419.2097436133575, 61.45346853027697], [384.66355245845915, 425.5507984128125, 80.32090613711665], [371.1856727099152, 417.2853364206364, 95.58843904698372], [383.89571709240954, 422.05894948585455, 90.34897796487444], [369.06967544015987, 415.0945011445405, 109.95626265464225], [363.905921764387, 410.30532694899847, 145.83082317105757], [374.062004523191, 404.26615499927703, 71.66788451385861], [365.1771943437611, 411.1684989232402, 138.8240628977576], [378.64766213802665, 419.68071384299856, 91.36665354093577], [392.4383310001942, 427.3678649231813, 87.16643966708286], [368.71396296045526, 417.65237530892654, 102.62433525869575], [369.1677608879877, 417.4033884227588, 101.51854686385032], [376.6149889086021, 395.9653268537694, 111.06958348999206], [358.94028020656935, 406.53079140630814, 126.29049046851034], [353.21522910346357, 398.15992456451295, 116.84781373830297], [394.4622672172091, 426.5378346666789, 28.167199709326272], [368.9543109886155, 417.89062690841513, 120.65720548659613], [370.0485326811761, 410.47286411535976, 114.37661559758453], [374.8460044249804, 411.5484412953245, 58.0279200357172], [365.22597793587585, 411.4716609888606, 135.5052961051074], [356.6036421297534, 412.78958996722275, 143.31530473716415], [391.518575330207, 429.59292229532093, 78.57306292235663], [345.00713356274764, 419.003599539843, 135.59793173924342], [353.9585191529595, 399.5713617282746, 118.6067369579606], [353.34496543365736, 398.41022582850525, 117.16564531169573], [353.47368051792654, 398.66087562662796, 117.48299461549404], [356.1009763129525, 403.16332763301205, 122.88916756890492], [359.5667933862161, 411.6320747290001, 144.63455516205664], [360.40709372247136, 428.26107768753343, 102.06642366455046], [373.2231014976325, 401.37895886926077, 49.4588939619581], [374.00561347763227, 415.37102458269146, 78.24416411397918], [371.13734378167146, 425.1039735959477, 119.73337162409318], [395.2275767625345, 409.1359029267458, 7.815266738546303], [409.215468914549, 422.92497197763834, -6.677620357322455], [370.10751414523367, 424.38156507050417, 37.55398188749668], [371.8517680939261, 423.35727386110267, 38.63591321770397], [395.18705162297056, 415.2342776279049, 5.388415415276651], [397.5716265575117, 425.64263880494354, 16.879066725522407], [395.6255330720497, 426.9556762664457, 28.95677624530821], [380.9277951312653, 429.6896128678285, -11.074792519004218], [390.4541198411512, 424.2501527442703, 26.704907017188592], [388.14799837439375, 422.381089096186, 25.707139860140963], [361.8987021002569, 415.74821595628646, 78.35134752877107], [373.7004003969379, 406.72324805436074, 73.96543990062], [374.12961408180615, 403.859270144511, 71.27606942007934], [363.8974612972301, 410.58107218367616, 144.42248262807638], [350.6074857740155, 415.6449162922335, 139.7565772133901], [377.41527333680943, 417.4406806593163, 53.70218322044945], [395.1674539516589, 426.7933031078055, 28.640457398443427], [388.5977203150467, 420.8278074114481, 4.470998055945413], [392.7989783891391, 412.7373096570357, 11.071866277628112], [383.87763571575135, 429.27649414196804, -10.377190801190084], [386.03474122792903, 402.95729542125287, 37.61939828007373], [375.79026517481486, 414.12304226799404, 20.21913154388382], [410.4025939057544, 417.61386532883944, 9.949165689749965], [374.9430262430159, 417.74700056983875, 64.60317448043659], [383.7694322019744, 419.2250831078132, 30.034342218200102], [380.0934786908042, 417.23312152802066, 25.32982792838559], [389.23500142791556, 420.69176129564727, 4.9432790014251795], [396.1007733763485, 431.37466385216095, -15.676447766882047], [369.50412950156766, 419.6598447673184, 120.32527619948489], [380.25024040745586, 422.6222315248098, 80.95194832229569], [374.0109483263557, 404.5738216676497, 71.9642330727689], [389.47128003373103, 425.4268698163721, 88.29435832735993], [357.13043480563323, 415.3506478191313, 72.50359074839821], [369.74734847287255, 417.1253993907928, 100.12685024824493], [371.49445681183784, 406.02410272016624, 113.55663171776193], [374.21255111673105, 406.83780800865276, 54.79024805966775], [367.28570065462327, 414.30974687402505, 123.52894113220759], [365.1961537762352, 411.2281107545299, 138.22534847330854], [364.1994351433164, 410.6276529052107, 143.80053966993722], [358.53216946756976, 406.08844467405845, 125.87253511610388], [354.3615190514418, 415.4194263414126, 69.00599431874713], [369.0220593281858, 415.7669807783256, 107.9283981279904], [370.1999020061582, 421.9181916303025, 120.00539486080723], [366.4544251091453, 426.2627147388968, 35.21569416912467], [389.87015220821183, 425.6823358054964, 88.14030916105284], [399.0876758952785, 419.73100673599754, 6.414015829771015], [373.8031810729767, 404.41781468261263, 52.44761253652566], [383.3420945837912, 406.78425015741936, 40.09288229940632], [353.61982243331306, 398.9441891519266, 117.83213750483782], [373.78977886555026, 439.81145598297337, 117.67614214169677], [373.82701411110077, 440.1289862861774, 117.63521165121855], [372.22586619439164, 423.1328768394186, 38.86236206573935], [358.41732122181014, 415.39850285840475, 74.15578274175562], [394.10563110345817, 421.91420897468333, 0.3485914923822885], [391.6234136022087, 414.9873191759676, 13.082935551898643], [373.6799053112263, 411.94887515120575, 15.64954357857001], [377.19553280683505, 417.3267064091501, 54.30080483153307], [391.0447598571818, 415.18265337961896, 13.854020355369991], [381.6209329294394, 423.6526563339204, 80.86588430764456], [366.0805950368746, 412.95176985365975, 126.83163899265575], [366.6128065008542, 413.5042528965256, 125.31622719627515], [365.2105920774711, 411.27441523549066, 137.76056772510992], [365.24022027125346, 411.38991653862246, 136.5598654976383], [345.81109593679236, 418.49389997541255, 136.20259653759112], [366.50032768968686, 413.38809682423516, 125.63705099607184], [378.24012539879277, 419.5589747109684, 91.31274579900678], [376.11995470175316, 414.40620052886965, 20.798072796172526], [367.3116647993677, 419.0838852626265, 103.67285675155512], [401.3109642715952, 421.8707021548509, -5.150465833390277], [396.5062505731828, 425.5623556668657, 31.94086248146355], [394.3936413379349, 422.8526797039146, -1.838842393735004], [365.07923696871245, 410.9913595796279, 140.61210540921763], [384.9948445474968, 419.9528710311741, 25.590400834034416], [373.711552062849, 418.6759369822679, 84.14785058905554], [398.0811259577645, 419.4465263423649, 6.134488914399675], [389.8953590608783, 419.89103297022, 17.87068080008854], [394.7946470177136, 423.52837228993627, -3.6920991549515185], [397.7960122298391, 428.0428716199117, 30.092818019605033], [397.62387887674646, 419.272754176614, 6.015871500608465], [393.9471895094109, 420.8094472321972, 2.6742521556912187], [384.2749303338579, 405.41587233255837, 39.23564987205495], [370.8663140405119, 433.40664018934643, 53.39221005668992], [380.81928229117113, 390.28110600572177, 109.81372995760964], [377.52480978281034, 419.3455905846257, 91.20279756347053], [380.8504334627727, 411.2371714077804, 42.366774386446714], [393.1228609739608, 412.34540591240403, 10.581338641245289], [395.1569778220648, 430.18245059811835, -14.333299427211077], [374.94168223292155, 398.7600411523768, 66.29967636002624], [379.6454220044152, 422.14975082984313, 80.9704213908965], [389.9588480215895, 420.53057014350145, 5.563090111603509], [393.93188437880485, 411.4013421401057, 9.371834112558444], [378.5154897252183, 393.268116047928, 110.47197288928375], [354.60221420901064, 413.6300134582289, 142.31205177921217], [377.09654253859895, 419.68694826031253, 41.08664739403004], [394.3773499680457, 422.7511422050881, 16.603059616891965], [385.38046897168266, 420.1634430699878, 25.28817586550374], [384.03859474617866, 419.3390066410434, 30.976326576190313], [374.9020491473677, 417.7151678719226, 63.765170744968884], [371.4537848941597, 417.85280686170165, 84.09608433504775], [372.8378091628284, 417.88527192303627, 92.60380515665811], [368.97845967817585, 414.42074323367444, 117.62440456715152], [394.6235650241425, 424.5420000850072, -5.748570629350284], [373.92489513956207, 405.09691501653947, 72.46730866766933], [353.1873807244996, 415.51348303603726, 67.57956738350882], [394.53339730168267, 423.086150841599, -2.478493264450477], [382.27982573823306, 429.5014610860271, -10.752947459511336], [372.26581836363806, 417.6789534587575, 93.58000420679687], [398.124851041363, 428.29189277293494, 30.15344511451905], [380.6855494124431, 417.56554204110245, 25.66094493672887], [392.50026748299, 430.2026059096108, 78.30234715667795], [375.1154410133869, 416.47224642122376, 59.86757646587191], [371.9754757957773, 417.57346820148626, 94.10091326267442], [365.20301197356775, 411.1000795183898, 139.53150563671463], [391.0961713946382, 427.81611292306013, -9.844684739541767], [383.51179567339204, 419.1321799743564, 26.296163211587157], [396.76081853077545, 423.21812603882626, -4.8812132714200835], [391.2163824201248, 420.21822164655333, 6.74560179753616], [378.42812420985547, 418.25220298027335, 42.421053522045106], [390.70501304489744, 420.3137570926705, 8.64853429866423], [391.2017308136161, 416.78982223632363, 13.98760509402351], [389.9113615157368, 428.10931999403465, -9.64762354566068], [378.549738773754, 421.2931586122781, 81.00374938482594], [375.82665121141935, 418.8448952098587, 90.94238062972755], [366.3346047030151, 420.3020841530909, 103.62002383793394], [369.3447584079306, 413.2840987268469, 113.28748491934148], [395.4131337317166, 423.85877213257135, -5.002388036894933], [393.3384526896196, 426.0224812319563, -7.787438483316905], [373.6807627524881, 418.2740228974556, 88.9675296653994], [369.1236579788919, 414.23095864372266, 112.2886761946489], [387.54812486169936, 424.2118837096332, 89.02976275036406], [361.7457127847375, 426.3672745731447, 102.62604378466429], [384.61005408934767, 419.5671473850056, 32.691130331666734], [373.0857538826902, 418.1505133536748, 87.52691731176425], [373.6022492160197, 418.5581431952073, 85.00499044832048], [395.0179405619876, 411.59047358669727, 7.095970078543798], [374.19322578902774, 418.7281882226487, 61.47189117595491], [375.0743542128, 419.2937631549639, 82.83596654684358], [363.00926904994634, 410.63832009130266, 145.2490988297098], [375.35277138995383, 417.85253352202363, 78.68173405697722], [369.06169560692643, 414.1251270833356, 117.07898296030085], [373.9903530315112, 441.48239878963443, 117.46390512768903], [392.750853899304, 427.9882721735898, -11.281533148089787], [375.3554269340686, 419.41023530260145, 82.57873938450658], [374.74233058560253, 417.3981101344615, 77.29602258597934], [393.67137728884006, 425.6213921590356, -7.219489615538127], [393.5215627548623, 428.2370095813156, -12.484184366825891], [393.039889715355, 426.4880078465542, -8.507851152906198], [383.367522233401, 419.0507670602386, 28.17354066753345], [392.1932624368818, 427.35346746794994, -9.654501934057738], [382.3754925272303, 416.29047048997, -7.509212763639421], [376.4495814181429, 419.2477384219719, 80.11216209856079], [369.59866019418166, 412.2108983963674, 114.50706685554988], [368.1694980525596, 415.5891713162171, 121.48037010423519], [351.76027788202254, 395.2030313773093, 113.03353798695503], [375.67427463676955, 418.2760447069017, 79.11245775092691], [386.5970283716596, 420.20174728533345, 34.652871909459726], [392.9407674289569, 419.7411188902517, 5.6617535500626275], [375.6344797676126, 415.0025503462659, 57.57416343595585], [391.407389022279, 416.0476499993646, 13.67489687808388], [392.6977149225327, 427.8560308357353, -10.969706437831494], [394.6094398508657, 419.325864055868, 4.660129075946341], [376.47152079149447, 416.6760102561026, 56.016002211115364], [390.78012719829724, 419.5091802331529, 12.707334132639362], [410.47638489858883, 423.2394166970171, -6.857275174021462], [374.0839642917645, 406.0297017182375, 54.03065805118497]]
test_lines= [[0, 583], [601, 46], [559, 552], [0, 540], [29, 573], [580, 598], [13, 378], [378, 458], [587, 552], [272, 117], [184, 188], [143, 584], [566, 571], [274, 97], [528, 555], [143, 376], [525, 376], [310, 7], [587, 585], [553, 586], [564, 540], [509, 12], [181, 492], [12, 492], [518, 599], [457, 2], [19, 193], [496, 4], [36, 514], [448, 14], [1, 16], [170, 507], [564, 515], [564, 554], [36, 189], [517, 17], [403, 600], [483, 142], [405, 199], [4, 15], [422, 205], [18, 484], [3, 385], [557, 217], [310, 370], [595, 555], [150, 203], [384, 313], [379, 377], [37, 529], [6, 439], [440, 602], [55, 200], [464, 383], [508, 397], [508, 317], [46, 217], [150, 387], [13, 19], [370, 186], [211, 312], [518, 181], [384, 312], [446, 31], [14, 534], [9, 588], [209, 11], [187, 28], [11, 187], [209, 186], [198, 190], [7, 380], [52, 9], [5, 588], [292, 308], [174, 303], [223, 54], [27, 447], [206, 359], [534, 511], [41, 553], [47, 533], [189, 307], [48, 218], [41, 547], [464, 547], [14, 35], [22, 586], [463, 535], [30, 196], [505, 196], [463, 22], [458, 544], [309, 485], [360, 485], [42, 190], [86, 8], [363, 42], [557, 555], [529, 524], [445, 32], [16, 45], [47, 377], [15, 493], [175, 192], [363, 53], [178, 53], [155, 160], [446, 544], [525, 219], [219, 466], [118, 207], [387, 304], [381, 597], [50, 398], [213, 50], [592, 368], [212, 208], [180, 208], [441, 163], [185, 441], [561, 148], [580, 584], [326, 497], [37, 439], [585, 565], [194, 447], [201, 27], [486, 39], [43, 39], [161, 460], [386, 390], [215, 63], [334, 73], [444, 379], [201, 205], [386, 131], [421, 279], [203, 202], [422, 455], [195, 317], [494, 212], [516, 32], [460, 505], [33, 398], [392, 546], [546, 516], [38, 400], [395, 400], [206, 33], [60, 66], [24, 393], [392, 393], [173, 172], [388, 23], [388, 556], [194, 448], [158, 161], [35, 26], [210, 301], [456, 465], [40, 314], [40, 396], [30, 390], [154, 295], [556, 49], [359, 594], [3, 443], [48, 594], [49, 44], [118, 311], [216, 210], [183, 316], [402, 523], [399, 314], [44, 396], [395, 402], [532, 154], [574, 159], [183, 519], [165, 51], [51, 358], [215, 358], [311, 315], [165, 214], [204, 63], [178, 461], [596, 406], [29, 385], [89, 328], [601, 10], [37, 573], [34, 195], [52, 191], [461, 173], [148, 566], [107, 346], [86, 484], [220, 198], [220, 8], [139, 401], [130, 404], [129, 177], [348, 221], [271, 222], [596, 106], [182, 136], [56, 182], [54, 354], [354, 454], [282, 289], [589, 65], [468, 527], [113, 271], [114, 320], [368, 110], [289, 360], [238, 332], [270, 112], [365, 479], [527, 560], [409, 140], [239, 479], [179, 306], [468, 326], [408, 391], [497, 240], [119, 319], [57, 112], [491, 68], [58, 240], [410, 356], [234, 356], [582, 437], [59, 391], [80, 83], [226, 428], [295, 232], [548, 126], [226, 247], [67, 247], [504, 71], [512, 62], [235, 147], [78, 65], [581, 78], [59, 67], [501, 500], [237, 255], [512, 537], [582, 319], [449, 222], [96, 449], [536, 462], [318, 462], [403, 495], [239, 61], [504, 415], [114, 227], [269, 333], [235, 236], [286, 126], [541, 64], [451, 364], [603, 309], [166, 474], [242, 302], [325, 270], [64, 450], [481, 93], [238, 364], [57, 450], [135, 241], [451, 413], [523, 301], [243, 294], [146, 294], [538, 545], [146, 526], [109, 506], [410, 340], [282, 436], [75, 491], [241, 325], [65, 153], [361, 327], [231, 322], [568, 249], [103, 258], [142, 362], [246, 340], [578, 539], [252, 69], [480, 252], [230, 472], [135, 244], [250, 480], [61, 471], [471, 75], [191, 184], [322, 251], [96, 321], [125, 127], [223, 342], [374, 92], [406, 425], [318, 361], [365, 287], [254, 149], [224, 254], [483, 470], [416, 362], [488, 489], [373, 472], [259, 373], [259, 256], [419, 265], [417, 109], [90, 293], [250, 411], [278, 266], [237, 257], [418, 230], [324, 263], [69, 109], [419, 260], [74, 260], [562, 255], [144, 292], [143, 144], [261, 347], [119, 149], [346, 110], [99, 433], [473, 281], [98, 345], [521, 134], [424, 98], [473, 108], [330, 281], [89, 366], [74, 141], [330, 261], [589, 593], [343, 120], [253, 72], [337, 105], [77, 475], [197, 99], [104, 273], [134, 334], [590, 424], [409, 256], [563, 590], [478, 145], [85, 268], [179, 438], [111, 335], [264, 88], [478, 420], [366, 420], [433, 285], [430, 335], [487, 430], [487, 432], [79, 262], [257, 262], [569, 79], [83, 117], [81, 435], [341, 103], [176, 539], [272, 344], [453, 275], [275, 233], [321, 68], [269, 116], [435, 338], [338, 192], [569, 81], [579, 152], [306, 116], [100, 510], [434, 273], [502, 276], [576, 92], [412, 137], [331, 453], [276, 339], [84, 331], [233, 339], [429, 502], [90, 115], [258, 105], [94, 423], [576, 412], [95, 336], [128, 352], [347, 229], [102, 229], [102, 253], [526, 245], [329, 336], [278, 328], [280, 285], [371, 293], [371, 120], [432, 431], [549, 159], [280, 111], [107, 279], [394, 443], [579, 489], [199, 207], [122, 349], [341, 283], [225, 467], [93, 438], [374, 434], [522, 70], [123, 284], [345, 108], [284, 519], [520, 177], [138, 166], [287, 542], [122, 288], [288, 436], [216, 43], [302, 245], [124, 290], [290, 349], [125, 82], [127, 350], [133, 351], [133, 130], [369, 129], [404, 221], [369, 352], [128, 132], [481, 225], [415, 236], [224, 327], [437, 324], [277, 531], [427, 277], [138, 355], [180, 158], [140, 550], [545, 550], [139, 342], [23, 401], [274, 308], [97, 291], [459, 382], [34, 213], [147, 234], [452, 477], [380, 188], [372, 174], [425, 355], [332, 243], [572, 571], [442, 490], [162, 156], [155, 482], [296, 367], [164, 490], [299, 298], [157, 298], [297, 367], [482, 157], [300, 353], [300, 156], [297, 353], [185, 299], [164, 232], [170, 168], [554, 168], [171, 357], [303, 171], [440, 169], [169, 357], [21, 496], [372, 507], [344, 175], [231, 248], [45, 10], [528, 465], [17, 394], [21, 305], [305, 10], [32, 397], [445, 455], [493, 381], [316, 382], [214, 323], [524, 457], [307, 26], [18, 513], [558, 597], [383, 131], [313, 494], [24, 66], [399, 218], [520, 348], [304, 405], [123, 486], [263, 244], [56, 407], [574, 407], [113, 320], [560, 153], [596, 600], [58, 408], [329, 80], [71, 522], [510, 551], [476, 414], [469, 541], [197, 145], [249, 470], [469, 413], [542, 167], [228, 82], [333, 337], [121, 567], [87, 267], [506, 562], [563, 567], [101, 578], [72, 265], [268, 498], [498, 503], [84, 375], [459, 323], [426, 501], [426, 267], [429, 115], [94, 176], [592, 91], [603, 474], [350, 351], [104, 427], [296, 160], [442, 163], [417, 418], [291, 151], [515, 543], [444, 202], [15, 2], [512, 572], [568, 246], [467, 423], [530, 141], [521, 76], [421, 431], [25, 95], [488, 283], [228, 136], [20, 602], [531, 375], [559, 389], [389, 193], [28, 456], [543, 509], [1, 533], [45, 514], [535, 570], [549, 106], [537, 227], [476, 500], [581, 575], [411, 121], [454, 495], [475, 591], [248, 416], [538, 148], [88, 85], [428, 548], [583, 565], [73, 530], [77, 499], [100, 477], [388, 38], [466, 200], [513, 517], [48, 570], [532, 49], [503, 499], [590, 101], [587, 598], [553, 511], [599, 17], [561, 70], [577, 593], [582, 577], [88, 266], [414, 551], [159, 536], [87, 264], [595, 599], [576, 452], [62, 575], [176, 591], [305, 558]]


class TestArabidopsis(unittest.TestCase):
    def test_build_graph(self):
        vertices = np.array(test_pts)
        edges = np.array(test_lines, dtype=int)
        G = arabidopsis.build_graph(vertices, edges)
        assert(len(G.edges) == len(test_lines))
        assert(len(G.nodes) == len(test_pts))

    def test_compute_tree_graph(self):
        T = arabidopsis.compute_tree_graph(test_pts, test_lines, 2, 1)



if __name__ == "__main__":
    unittest.main()
